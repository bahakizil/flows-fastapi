graph TB
    subgraph "Frontend Layer"
        RF[ReactFlow Canvas]
        NP[Node Palette]
        PP[Property Panel]
        EC[Execution Console]
    end
    
    subgraph "API Layer"
        API[REST API]
        WS[WebSocket Server]
        AUTH[Authentication]
    end
    
    subgraph "Core Engine"
        WE[Workflow Engine]
        CFE[ChatFlow Executor]
        NSP[Nodes Pool]
        SM[State Manager]
    end
    
    subgraph "Node System"
        subgraph "Chat Models"
            OPENAI[ChatOpenAI Node]
            CLAUDE[Claude Node]
            LLAMA[Llama Node]
        end
        
        subgraph "Chains"
            LLMC[LLM Chain Node]
            CONV[Conversation Chain]
            RETR[Retrieval Chain]
        end
        
        subgraph "Tools"
            CALC[Calculator Tool]
            SEARCH[Search Tool]
            API_TOOL[API Tool]
        end
        
        subgraph "Memory"
            BUFFER[Buffer Memory]
            SUMMARY[Summary Memory]
            VECTOR[Vector Memory]
        end
        
        subgraph "Agents"
            REACT[ReAct Agent]
            PLAN[Plan Execute Agent]
            CONV_AGENT[Conversational Agent]
        end
    end
    
    subgraph "External Services"
        OPENAI_API[OpenAI API]
        PINECONE[Pinecone DB]
        REDIS[Redis Cache]
        POSTGRES[PostgreSQL]
    end
    
    subgraph "LangChain Integration"
        LC_MODELS[LangChain Models]
        LC_CHAINS[LangChain Chains]
        LC_TOOLS[LangChain Tools]
        LC_MEMORY[LangChain Memory]
    end
    
    %% Frontend connections
    RF --> API
    NP --> API
    PP --> API
    EC --> WS
    
    %% API Layer connections
    API --> WE
    WS --> WE
    AUTH --> API
    
    %% Core Engine connections
    WE --> CFE
    WE --> NSP
    WE --> SM
    CFE --> NSP
    
    %% Node System connections
    NSP --> OPENAI
    NSP --> CLAUDE
    NSP --> LLAMA
    NSP --> LLMC
    NSP --> CONV
    NSP --> RETR
    NSP --> CALC
    NSP --> SEARCH
    NSP --> API_TOOL
    NSP --> BUFFER
    NSP --> SUMMARY
    NSP --> VECTOR
    NSP --> REACT
    NSP --> PLAN
    NSP --> CONV_AGENT
    
    %% External Service connections
    OPENAI --> OPENAI_API
    CLAUDE --> OPENAI_API
    VECTOR --> PINECONE
    SM --> REDIS
    WE --> POSTGRES
    
    %% LangChain Integration
    OPENAI --> LC_MODELS
    LLMC --> LC_CHAINS
    CALC --> LC_TOOLS
    BUFFER --> LC_MEMORY
    
    %% Styling
    classDef frontend fill:#e1f5fe
    classDef api fill:#f3e5f5
    classDef core fill:#e8f5e8
    classDef nodes fill:#fff3e0
    classDef external fill:#ffebee
    classDef langchain fill:#f1f8e9
    
    class RF,NP,PP,EC frontend
    class API,WS,AUTH api
    class WE,CFE,NSP,SM core
    class OPENAI,CLAUDE,LLAMA,LLMC,CONV,RETR,CALC,SEARCH,API_TOOL,BUFFER,SUMMARY,VECTOR,REACT,PLAN,CONV_AGENT nodes
    class OPENAI_API,PINECONE,REDIS,POSTGRES external
    class LC_MODELS,LC_CHAINS,LC_TOOLS,LC_MEMORY langchain

